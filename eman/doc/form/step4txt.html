$0
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Steve Ludtke">
</head>
<body>
<h1>EMAN Reconstruction - Phase 4</h1>
<hr>
<p>In this step we analyze the quality of the model generated in step 3.
There are several steps to
this process. First, you should have a look at the class-averages generated
after each step of the reconstruction. Start by running <i>eman</i> from
the same directory you ran <i>refine</i> from.

<p>Press the 'Browse Files/History' button. This will cause the main browser window
to appear. In the lower left will be a list of all of the files in the current
directory. In the lower right is a list of the command history for this
directory. In the top of the window are the various inspectors. Start by
selecting the classes file for the first iteration, <i>classes.1.img</i> in
the file list. Then select the 'File' inspector tab. You'll see the first image
in the file displayed in the upper left. The <i>classes</i> files contain
projections and the corresponding class averages. The first image is a
projection, the second is a class average, the third is a projection, etc.
First, just to get an overview,
hit the <i>Big View</i> button. This will let you look at all of the images in
the file at once. In the first iteration, the class averages may not match the
projections very well. Look through the other <i>classes.?.img</i> files and
see if things seem to be improving.

<p>For a more qualitative view, select the <i>Compare Images</i> tab. When this
inspector is in 'classes' mode (selected to the right of the images),
a projection will be displayed on the right, and the corresponding class
average will be displayed on the right. The difference between these 2 images
is displayed in the middle. When the refinement has converged, the projections
and class averages should be nearly identical except for noise. That is, the center
image should look like flat noise without any recognizable structure. If you did
CTF correction with ctfc= (rather than ctfcw=), you may see a noisy texture in the
class averages. This is a filtration artifact, and should not be present in the 3D
models or projections. If it is, you should consider using a lower resolution with
ctfc=.

<p>If the class averages look ok, you can take a look at the 3d reconstructions.
There are 3 volume images generated in each iteration: <i>threed.?.mrc</i>,
<i>threed.?a.mrc</i> and <i>x.?.mrc</i>. The third image will be generated only
if you specified the <i>xfiles</i> option in the <i>refine</i> command. The
first file is the raw reconstruction, the second is the reconstruction with
iterative real-space corrections, and an optional mild low-pass filter,
and the third has been cropped to twice the
mask radius, optionally scaled to a particlular mass, and optionally aligned
to an earlier iteration. If the third set is present, they are the best
ones to examine. Otherwise look at the second set. If you have some other
program (like Iris Explorer) you like to use to examine MRC volume data, go
ahead and look at the reconstructions after each iteration. The EMAN file
browser will allow you to examine the 3D model in projection. Select the
3D model in the file list, then use the <b>right</b> mouse button to
rotate it. <i>v4</i> allows you to compare several models side by side.
For isosurface views, and better comparisons, we
suggest vis5d (http://www.ssec.wisc.edu/~billh/vis5d.html). A
copy of this program is included in the EMAN distribution for your
convenience, although it is a completely separate product, and credit
should be given to the authors of that package if it is used for
publications, etc. EMAN includes <i>mrc2v5dt</i> to convert MRC data to
a format compatible with vis5d. To use this program, just do:
<pre>mrc2v5dt &lt;mrc file 1&gt; &lt;mrc file 2&gt; ... &lt;output .v5d file&gt;</pre>

<p>If you recall, in step 1 it was mentioned that you could apply a high-pass filter
to the raw particle data. If you followed this advice, you may now wish
to remove this filter (but NOT if you used the setsf= option in refine). This can be
accomplished with the following command:
<pre>proc3d threed.1a.mrc x.1.mrc unhp=1</pre>

<p>If the 3D reconstructions seem to be converging towards something, you should
take a look at the convergence more qualitatively. Run <i>eman</i> and select
the directory the refinement was run in. Then select <i>Convergence</i> on the
<i>Analysis</i> menu. This will calculate the the Fourier Shell Correlation
between the 3D models generated after each iteration. It will also generate
one for the even/odd models generated by the <i>eotest</i> command (if present).
All of these curves will then be plotted. What you will generally see is a curve
starting high at low resolution, gradually falling off at higher resolution,
and eventually levelling off near zero. Occasionally you will see this curve
rising again at high resolution. This is not indicative of improving resolution
in your model, but rather undersampling at high resolution in Fourier space. If
you see this effect occuring at a lower resolution than your goal in the
reconstruction, this means you need to use a smaller angular increment (<i>ang=</i>
in the <i>refine</i> command. The point at which this curve begins to fall off
rapidly is a good indicator of your final resolution.

<br><p>For a more reliable resolution measurement, however, a more robust test
is required. EMAN contains an automatic routine for performing a even/odd test.
EMAN does this by generating 2 class averages for each <i>cls????</i> file. Each
of these averages will use only 1/2 of the images in the <i>cls</i>file. Two
3D models are then generated, <i>threed.te.mrc</i> and <i>threed.to.mrc</i>.
Comparing these models will give an accurate estimate of the reconstruction
resolution. Note that if you have a barely sufficient number of images in each
class before the test, the even/odd test results will give an inaccurate
resolution (it will be lower than it should be). The class alignment procedure
really requires a minimum of 8-10 particles to work reliably. If you have
less than twice this many particles in many of your classes, the even/odd test is
likely to underestimate your resolution. The options in the <i>eotest</i>
command are taken from the options used in the <i>refine</i> command. We currently
suggest using a fixed .5 or .3 FSC threshold for determining resolution in the
convergence plot. At present there is no option for plotting a simple 3-sigma curve because
it tends to produce unreliable results and has some fundamental mathematical
flaws. Keep in mind, however, that real-space resolvability is actually
~1.5 times better than the Fourier resolution cutoff. Qualitatively this means if
you use a fairly strong criteria, say, .7-.8, and determine a resolution of, for
example, 12 &Aring;, you will actually be able to (barely) resolve 8-9 &Aring;
features in the map. However, you should keep in mind that the reliability of features
near the resolution limit in scale is fairly low. That is, if you refine to 10 &Aring;
resolution, you should probably not try to make comments on small shifts or gaps in
your alpha-helices, even if they are largely present and correct.

<br><p>If everything has gone well, you now have a self-consistent model at some resolution.
However, this does not say that you have the correct model, and, of course, you may not
have the optimal resolution yet. If your particle has at least 1 C3 symmetry and you've determined
this much properly, your model is likely to be correct. Asymmetric particles are more difficult. There
are cases where several different models can be constructed from the same set of data and all
will appear to be consistent with the data. This generally occurs when the particles have a strongly
preferred orientation. In any case, you must be very careful about making conclusions about asymmetric
models. Additional tests that should be performed in this case is beyond the scope of this
document.

<br><p>There are, of course many other tools available for analysis of 3D models. EMAN includes the
'helixhunter' program, for locating alpha-helices in models with 6-10 &Aring; resolution. It also
includes 'foldhunter' which can perform automatic fitting of x-ray models into EM maps of sufficient
resolution (this, of course, depends on the structure in question). 'pdb2mrc' is provided
to generate maps from PDB files for use with 'foldhunter'. Finally, EMAN includes 'qsegment'
for interactive 3D map segmentation and examining the model slice-by-slice from any orientation.

</body>
</html>
