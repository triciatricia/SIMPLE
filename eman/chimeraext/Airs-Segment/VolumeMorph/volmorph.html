<html>
<head>
<title>Airs-Segment - Volume Morph</title>
<style type="text/css">
<!-- 
body 				{ width: 640px; margin: auto; padding: 24px;
							font: Verdana, Arial, Helvetica, sans-serif; }
p 					{	text-align: justify; padding-left: 16px; }
.highlight 	{ color: #006699; }
.code 			{ color: #666666; }
-->
</style>
</head>

<body>
<h2>Volume Morph</h2>

<img src="volmorph.gif"> <!-- icon -->

<h3>Introduction</h3>

<p>The <span class="highlight">Volume Morph</span> module
is available as a part of the 
<a href="../SegmentHelp/index.html">Airs-Segment</a> package. The module 
is a <span class="highlight">Chimera</span> extension module. 
To use this module, the <span class="highlight">Segment Menu</span> 
module of the <span class="highlight">Airs-Segment</span> package 
is required. You will need the 
<a href="http://www.cgl.ucsf.edu/chimera/">Chimera</a> and
<a href="http://ncmi.bcm.tmc.edu/~steve/EMAN/doc/">EMAN</a> software 
packages to use this module. 
</p>

<p>The module helps morph a 3D density map displayed in 
Chimera using deformation specified by two atomic models. 
</p>

<p><b>Note:</b> This version of the Airs-Segment package is
a pre-release version.</p>

<h3>More:</h3>

<ul>
	<li><a href="#startup">Startup</a>
		<ul>
			<li><a href="#list">Listing the module</a></li>
			<li><a href="#start">Starting the module</a></li>
		</ul>
	</li>
	<li><a href="#dialog">Dialog</a>
		<ul>
			<li><a href="#datasec">Input data section</a></li>
			<li><a href="#sm">Simple Morph</a> parameters</li>
			<li><a href="#mo">Morph Output</a> parameters</li>
			<li><a href="#outsec">Output data section</a></li>
			<li><a href="#buttons">Other buttons</a></li>
		</ul>
	</li>
	<li><a href="#example">Example</a></li>
<!--	<li><a href="#command">Command line options</a> (for advanced users)
		<ul>
			<li><a href="#commandget">Get transform of a model</a></li>
			<li><a href="#commandapply">Apply a transform to a model</a></li>
		</ul>
	</li> -->
	<li><a href="#notes">Notes</a>
		<ul>
			<li><a href="#filter">Filtering</a></li>
		</ul>
	</li>
</ul>

<hr>

<a name="startup"></a>
<h3>Startup</h3>

<a name="list"></a>
<h4>Listing the module</h4>

<p>The module files are stored in the directory 
<span class="highlight">VolumeMorph</span>. To list the module under 
Chimera's <span class="highlight">Tools</span> menu, add the directory 
-&nbsp;containing&nbsp;- the <span class="highlight">VolumeMorph</span> 
directory to Chimera's list of Tools.</p>

<p>To do so, open Chimera's main window, choose 
<span class="highlight">Perferences</span> under 
<span class="highlight">Favorites</span> menu, then choose the 
<span class="highlight">Tools</span> category and then 
<span class="highlight">Add</span> the directory -&nbsp;containing&nbsp;- 
the <span class="highlight">VolumeMorph</span> directory. This will 
list the tool under <span class="highlight">AIRS</span> on the 
<span class="highlight">Tools</span> menu.</p>

<a name="start"></a>
<h4>Starting the module</h4>

<p>To start the module from the Chimera menu, first you will need to ensure 
that the module is <a href="#list">listed</a> under Chimera's 
<span class="highlight">Tools</span> menu. Then, click on 
<span class="highlight">Volume Morph</span> in the 
<span class="highlight">AIRS</span> menu, under Chimera's 
<span class="highlight">Tools</span> menu.</p>

<p>Alternatively, you can use the command line tool in Chimera's 
<span class="highlight">IDLE</span> tool (under Programming tools 
on the Tools menu), and type: </p>

<p>
<span class="code">
&nbsp;&nbsp;&gt;&gt;&gt; import VolumeMorph<br>
&nbsp;&nbsp;&gt;&gt;&gt; VolumeMorph.volmorph.show_vol_morph_dialog() 
</span>
</p> 

<hr>

<a name="dialog"></a>
<h3>Dialog</h3>

<p><img src="volmorph.png" align="right" 
style="margin-left:16px; margin-bottom:8px "></p>

<a name="datasec"></a>
<h4>Input data section</h4>

<p>The Volume Morph dialog panel has five main sections. The first section 
is the Input data section. The <span class="highlight">Data file menu</span> 
automatically lists available data regions in Chimera's 
<span class="highlight">Volume Viewer</span>. The 
<span class="highlight">Morph models menu</span> lists all Chimera open
models including volume data regions in Chimera's 
<span class="highlight">Volume Viewer</span>.</p>

<p>
To select an input (volume) data set, 
simply pick an entry from the <span class="highlight">Data file</span> menu. 
The size of the input data set in pixels 
is automatically displayed on the dialog, below the menu. If the data set 
is displayed in Chimera, then the <span class="highlight">Displayed</span> 
value is set to <span class="highlight">Yes</span>.</p>

<p>To open new models, click the <span class="highlight">Open</span> 
button below the menu. This will open Chimera's 
<span class="highlight">Volume Viewer</span> dialog and an 
<span class="highlight">Open file browser</span> dialog. After adding 
the models, if the models are not listed on the data menu, click the 
<span class="highlight">Refresh menu</span> button, next to the 
<span class="highlight">Open button</span> on the 
<span class="highlight">Volume Morph</span> dialog.</p>

<p>Alternatively, you can directly open new models using Chimera's 
<span class="highlight">Volume Viewer</span>. Once again, if the newly 
opened models are not displayed on the data menu, hit the 
<span class="highlight">Refresh menu</span> button.</p>

<p>
To select an input morph models, simply pick an entry from the 
<span class="highlight">Morph models menus</span>. The two models 
are used to specify the deformation using atom positions.
</p>

<p>
To open new models, use Chimera's <span class="highlight">File menu</span>
on the Chimera main window to open models (volume data or PDB structures).
</p>

<a name="sm"></a>
<h4>Simple Morph parameters</h4>

<p>
You can perform a simple morph (linear deformation) on the input data,
in terms of the displacement of the atoms in the two input atomic models 
(morph models). The two atomic models are assumed to have one-to-one 
correspondence between the atoms. To display options for this type of 
morphing, check the <span class="highlight">Simple</span> box 
in the list of panels at the top of the dialog.
</p>

<p>
The <span class="highlight">Fraction</span> parameter should be 
between 0.1 and 1.0 and specifies the fraction of displacemnt 
(between atom positions) that should be used for morphing. 
</p>

<p>
To use a threshold, check the <span class="highlight">Threshold</span>
box and specify a value. 
</p>

<p>
To apply a filter (lowpass), after morphing, check the 
<span class="highlight">Filter</span> box and specify
a lowpass parameter in Angstroms. This filter is 
applied using the <span class="highlight">EMAN</span> 
software (<span class="highlight">proc3d</span> command).
</p>

<a name="mo"></a>
<h4>Morph Output</h4>

<p>
This section allows you to chose the type of morphing
you want to apply. Currently, only a 
<span class="highlight">Simple</span> morphing
(based on linear deformations is supported).
</p>

<p>
You can specify an output file name, and the morphed
density is saved as a density map in MRC format.
</p>

<p>
The <span class="highlight">Apply</span> button applies
the morphing to the input density map, based on 
the <a href="#datasec">Morph models</a> and the type of 
morphing.
</p>

<a name="outsec"></a>
<h4>Output data section</h4>

<p>The output data section has an 
<span class="highlight">Output data menu</span> that lists the 
current morphed output files. To open or display the file in Chimera, 
click on the <span class="highlight">Show</span> button. If more 
than one output file was created, then you can click on 
<span class="highlight">Show All</span> button to open and display 
all the files on the menu. </p>

<p>The <span class="highlight">Hide</span> button closes the model 
(associated with the file on the 
<span class="highlight">Output data menu</span>) in Chimera, but 
leaves the entry on the <span class="highlight">Volume Viewer</span> 
data menu unchanged. The <span class="highlight">Hide All</span> 
button applies the <span class="highlight">Hide</span> button to all 
the files on the output data menu.</p>

<p>The <span class="highlight">Remove All</span> button removes all the 
entries on the <span class="highlight">Output data menu</span>, but 
leaves the corresponding entries (if any) on the 
<span class="highlight">Volume Viewer</span> data menu unchanged.</p>

<a name="buttons"></a>
<h4>Other buttons</h4>

<p>The <span class="highlight">Close</span> button closes the 
<span class="highlight">Volume Morph</span> dialog. The 
<span class="highlight">Help</span> button opens this help page.</p>

<hr>

<a name="example"></a>
<h3>Example</h3>

<p><img src="volmorphentry.png"></p>

<p>
We select <span class="highlight">Simple</span> morphing, 
set <span class="highlight">Fraction</span> to 1.0, 
set <span class="highlight">Filter</span> to 48 Angstroms,
and then apply morphing.
</p>

<p><img src="volmorpheg1.png" align="left">&nbsp;<img src="volmorpheg2.png"></p>

<p>
In the left figure, we have the 
two morph models (atomic structures). The morphing 
is specified by the displacement of the atoms 
(from pink to bluish-green).
</p>

<p>
In the right figure, we have the 
input (red) and morphed (blue) volume density.
</p>

<hr>

<!-- <a name="command"></a>
<h3>Command-line options (for advanced users)</h3>

<a name="commandget"></a>
<h4>Get a Chimera transform</h4>

<p>To get the transform object of a Chimera model, simply type:<br>
<span class="code">
&nbsp;&nbsp;&gt;&gt;&gt; import SegmentTrack<br>
&nbsp;&nbsp;&gt;&gt;&gt; SegmentTrack.trackxform.get_xform(model)
</span>
</p>

<p>To get help, type:<br>
<span class="code">
&nbsp;&nbsp;&gt;&gt;&gt; help(TrackXform.get_xform)
</span></p>

<a name="commandapply"></a>
<h4>Apply a Chimera transform</h4>

<p>To apply the transform object to a Chimera model, simply type:<br>
<span class="code">
&nbsp;&nbsp;&gt;&gt;&gt; import SegmentTrack<br>
&nbsp;&nbsp;&gt;&gt;&gt; SegmentTrack.trackxform.update_xform(model, xform)
</span>
</p>

<p>To get help, type:<br>
<span class="code">
&nbsp;&nbsp;&gt;&gt;&gt; help(SegmentTrack.trackxform.update_xform)
</span></p>

<hr> -->

<a name="notes"></a>
<h3>Notes</h3>

<a name="filter"></a>
<h4>Filtering</h4>

<p>The filter currently calls 
<span class="highlight">proc3d</span> command of 
<span class="highlight">EMAN</span>, and applies a
lowpass filter. The equivalent command line option 
for a lowpass filter of 48 Angstroms would be:
</p>

<p>
<span class="code">
proc3d morph.mrc morph_and_filter.mrc lp=48
</span>
</p>

<hr>

<span class="highlight">
<i>Airs-Segment package (pre-release) - Volume Morph module<br>
2006 June, Lavu Sridhar, Baylor College of Medicine</i>
</span>

</body>

</html>